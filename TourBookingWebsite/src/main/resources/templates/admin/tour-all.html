<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <!-- <head>
    <title>Danh Sách Tour</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link type="text/css" href="/css/navBar.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link type="text/css" href="/admin/css/tour.css" rel="stylesheet" />
        <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="/js/narBar.js"></script>
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
</head> -->
  <head>
    <title>Danh Sách Tài Khoản</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Custom CSS -->
    <link type="text/css" href="/css/navBar.css" rel="stylesheet" />
    <link type="text/css" href="/admin/css/tour.css" rel="stylesheet" />

        <link type="text/css" href="/admin/css/tourTime.css" rel="stylesheet" />
        <link type="text/css" href="/admin/css/category.css" rel="stylesheet" />
    

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JS -->
    <script src="/js/narBar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <div th:replace="MenuAdmin :: navbar"></div>

    <!-- Thông báo -->
    <div
      id="alert-container"
      style="position: fixed; top: 20px; right: 20px; z-index: 1000000"
    ></div>
<!-- Modal xác nhận xóa -->
<div class="modal fade" id="confirmDeleteTourTimeModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteTourTimeModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmDeleteTourTimeModalLabel">Xác Nhận Xóa</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Bạn có chắc chắn muốn xóa TourTime này không?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
        <button type="button" class="btn btn-danger" id="confirmDeleteTourTimeButton" onclick="deleteTourTime()">Xóa</button>
      </div>
    </div>
  </div>
</div>


    <div
      class="modal fade"
      id="confirmDeleteModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="confirmDeleteModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmDeleteModalLabel">
              Xác Nhận Xóa
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            Bạn có chắc chắn muốn xóa tour này không?
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Hủy
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="confirmDeleteButton"
            >
              Xóa
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="text-center">
        <h1>Danh Sách Tour</h1>
      </div>

      <!-- Tab Navigation -->
      <ul class="nav nav-tabs" id="myTab" role="tablist">
		  <li class="nav-item" role="presentation">
		    <button
		      class="nav-link active"
		      id="quan-ly-tour-tab"
		      data-bs-toggle="tab"
		      data-bs-target="#quan-ly-tour"
		      type="button"
		      role="tab"
		      aria-controls="quan-ly-tour"
		      aria-selected="true"
		    >
		      Danh sách Tour
		    </button>
		  </li>
		  <li class="nav-item" role="presentation">
		    <button
		      class="nav-link"
		      id="loai-tour-tab"
		      data-bs-toggle="tab"
		      data-bs-target="#loai-tour"
		      type="button"
		      role="tab"
		      aria-controls="loai-tour"
		      aria-selected="false"
		    >
		      Loại Tour
		    </button>
		  </li>
		  <li class="nav-item" role="presentation">
		    <button
		      class="nav-link"
		      id="lich-trinh-tour-tab"
		      data-bs-toggle="tab"
		      data-bs-target="#lich-trinh-tour"
		      type="button"
		      role="tab"
		      aria-controls="lich-trinh-tour"
		      aria-selected="false"
		    >
		      Lịch trình Tour
		    </button>
		  </li>
		</ul>
<!-- -------------------------------------------------------- TOUR------------------------------------------------------------------ -->

      <div class="tab-content" id="myTabContent">
        <!-- Quản lý Tour Tab -->
        <div
          class="tab-pane fade show active"
          id="quan-ly-tour"
          role="tabpanel"
          aria-labelledby="quan-ly-tour-tab"
        >
          <!-- Thanh Tìm Kiếm và Các Ô Select -->
<div class="filter-section mb-2">
    <form id="searchForm" onsubmit="return false;">
        <!-- Hàng chứa ô input tìm kiếm -->
        <div class="row g-2 mb-2">
            <div class="col-md-8 pt-1">
                <div class="input-group">
                    <input
                        type="text"
                        id="searchInput"
                        class="form-control border border-secondary"
                        placeholder="Tìm kiếm theo ID, Tên, Mã Tour"
                        aria-label="Search"
                        oninput="filterTours()"
                    />
                    <button
                        type="button"
                        class="btn btn-primary btnsearchtour"
                        onclick="filterTours()"
                    >
                        Tìm kiếm
                    </button>
                    <!-- Nút Clear bên cạnh nút Tìm kiếm -->
                    <button
                        type="button"
                        id="clearbtnTour"
                        class="btn btn-secondary ms-2"
                        onclick="clearFormSearch()"
                    >
                        Clear
                    </button>
                </div>
            </div>
        </div>

        <!-- Hàng chứa các ô select và nút Thêm Tour Mới -->
        <div class="row g-2 align-items-center">
            <div class="col-md-5 d-flex">
                <div class="col-md-4">
                    <select
                        id="statusSelect"
                        class="form-select"
                        onchange="filterTours()"
                    >
                        <option value="">Chọn Trạng Thái</option>
                        <option value="1">Kích hoạt</option>
                        <option value="0">Ngưng hoạt động</option>
                    </select>
                </div>
                <div class="col-md-6 ms-2">
                    <select
                        id="categorySelect"
                        class="form-select"
                        onchange="filterTours()"
                    >
                        <option value="">Chọn Loại Tour</option>
                        <!-- Dữ liệu sẽ được tải động từ API -->
                    </select>
                </div>
            </div>
            <div class="col-md-7 text-end">
                <div class="add-tour-btn text-end">
                    <button
                        class="btn btn-success"
                        data-bs-toggle="modal"
                        data-bs-target="#addTourModal"
                    >
                        Thêm Tour Mới
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>



          <!-- Bảng hiển thị danh sách Tour -->
          <div class="table-container">
            <table class="table table-bordered text-center">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Tên Tour</th>
                  <th>Chi Tiết Tour</th>
                  <th>Trạng Thái</th>
                  <th>Mã Tour</th>
                  <th>Thời Gian Lưu Trú</th>
                  <th>Loại Tour</th>
                  <th>Thao Tác</th>
                </tr>
              </thead>
              <tbody id="tourTableBody">
                <!-- Nội dung sẽ được tải động bởi Ajax -->
              </tbody>
            </table>
          </div>
        </div>

    <!-- Modal thêm tour mới -->
    <div
      class="modal fade"
      id="addTourModal"
      tabindex="-1"
      aria-labelledby="addTourModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addTourModalLabel">Thêm Tour Mới</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="addTourForm" onsubmit="addTour(); return false;">
              <div class="mb-3">
                <label for="tourName" class="form-label">Tên Tour</label>
                <input
                  type="text"
                  class="form-control"
                  id="tourName"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="tourDetail" class="form-label">Chi Tiết Tour</label>
                <textarea
                  class="form-control"
                  id="tourDetail"
                  required
                ></textarea>
              </div>
              <div class="mb-3">
                <label for="tourCategory" class="form-label">Loại Tour</label>
                <select class="form-select" id="tourCategory" required>
                  <!-- Dữ liệu sẽ được tải động -->
                </select>
              </div>
              <div class="mb-3">
                <label for="tourStatus" class="form-label">Trạng Thái</label>
                <select class="form-select" id="tourStatus" required>
                  <option value="1">Kích hoạt</option>
                  <option value="0">Ngưng hoạt động</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="tourCode" class="form-label">Mã Tour</label>
                <input
                  type="text"
                  class="form-control"
                  id="tourCode"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="dayStay" class="form-label">Số Ngày Ở</label>
                <input
                  type="number"
                  class="form-control"
                  id="dayStay"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">Thêm Tour</button>
              <button
                type="button"
                class="btn btn-secondary"
                id="clearTourForm"
              >
                Clear
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal chỉnh sửa tour -->
    <div
      class="modal fade"
      id="editTourModal"
      tabindex="-1"
      aria-labelledby="editTourModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editTourModalLabel">Chỉnh Sửa Tour</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editTourForm" onsubmit="editTourDetails(); return false;">
              <div class="mb-3">
                <label for="editTourName" class="form-label">Tên Tour</label>
                <input
                  type="text"
                  class="form-control"
                  id="editTourName"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="editTourDetail" class="form-label"
                  >Chi Tiết Tour</label
                >
                <textarea
                  class="form-control"
                  id="editTourDetail"
                  required
                ></textarea>
              </div>
              <div class="mb-3">
                <label for="editTourCategory" class="form-label"
                  >Loại Tour</label
                >
                <select class="form-select" id="editTourCategory" required>
                  <!-- Dữ liệu sẽ được tải động -->
                </select>
              </div>
              <div class="mb-3">
                <label for="editTourStatus" class="form-label"
                  >Trạng Thái</label
                >
                <select class="form-select" id="editTourStatus" required>
                  <option value="1">Kích hoạt</option>
                  <option value="0">Ngưng hoạt động</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="editTourCode" class="form-label">Mã Tour</label>
                <input
                  type="text"
                  class="form-control"
                  id="editTourCode"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="editDayStay" class="form-label">Số Ngày Ở</label>
                <input
                  type="number"
                  class="form-control"
                  id="editDayStay"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">
                Lưu Thay Đổi
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                id="clearEditTourForm"
              >
                Clear
              </button>
              <input type="hidden" id="editTourId" />
            </form>
          </div>
        </div>
      </div>
    </div>

   <!-- Modal -->
<div class="modal fade" id="tourImageModal" tabindex="-1" aria-labelledby="tourImageModalLabel" aria-hidden="true">
  <input type="hidden" id="currentTourId" />
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="tourImageModalLabel">Quản lý Hình Ảnh Tour</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Section for adding a new image -->
        <div id="addImageSection" class="mb-3">
          <h5>Thêm ảnh mới</h5>
          <form id="addImageForm">
            <div class="mb-3">
              <label for="newImage" class="form-label">Chọn ảnh</label>
              <input type="file" class="form-control" id="newImage" name="newImage" accept="image/*" required>
            </div>
            <div class="mb-3">
              <label for="imageStatus" class="form-label">Trạng Thái</label>
              <select class="form-select" id="imageStatus" name="imageStatus" required>
                <option value="1">Ảnh chính</option>
                <option value="0">Ảnh phụ</option>
              </select>
            </div>
            <button type="submit" class="btn btn-success">Thêm ảnh</button>
          </form>
        </div>

        <!-- Table of Existing Images -->
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">Ảnh</th>
              <th scope="col">Trạng Thái</th>
              <th scope="col">Chức Năng</th>
            </tr>
          </thead>
          <tbody id="imageTableBody">
            <!-- Dynamically filled with images from the server -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Modal to view the large image -->
<div class="modal fade" id="viewImageModal" tabindex="-1" aria-labelledby="viewImageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="viewImageModalLabel">Xem Hình Ảnh</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <img id="largeImage" src="" alt="Large Image" class="img-fluid" />
      </div>
    </div>
  </div>
</div>

<!-- Modal to edit the image -->
<div class="modal fade" id="editImageModal" tabindex="-1" aria-labelledby="editImageModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editImageModalLabel">Chỉnh Sửa Hình Ảnh</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editImageForm">
          <input type="hidden" id="editImageId" />
          <div class="mb-3">
            <label for="editImageUrl" class="form-label">URL Ảnh</label>
            <input type="text" id="editImageUrl" class="form-control" />
          </div>
          <div class="mb-3">
            <label for="editImageStatus" class="form-label">Loại</label>
            <select id="editImageStatus" class="form-control">
              <option value="1">Ảnh chính</option>
              <option value="0">Ảnh phụ</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="editImageFile" class="form-label">Chọn Tệp Ảnh</label>
            <input type="file" id="editImageFile" class="form-control" />
          </div>
          <button type="submit" class="btn btn-primary">Lưu Thay Đổi</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal để hiển thị danh sách TourTime -->
<div class="modal fade" id="tourTimeModal" tabindex="-1" aria-labelledby="tourTimeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="tourTimeModalLabel">Danh Sách Thời Gian Tour</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Bảng danh sách TourTime -->
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>ID</th>
              <th>Mã Tour Time</th>
              <th>Tên Thời Gian</th>
              <th>Thời Gian Khởi Hành</th>
              <th>Thời Gian Trở Lại</th>
              <th>Giá Người Lớn</th>
              <th>Giá Trẻ Em</th>
              <th>Trạng Thái</th>
            </tr>
          </thead>
          <tbody id="tourTimeTableBody">
            <!-- Dữ liệu sẽ được tải động ở đây -->
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
      </div>
    </div>
  </div>
</div>





<!-- -------------------------------------------------------- LOẠI TOUR------------------------------------------------------------------ -->

<!-- Loại Tour Tab -->
<div
  class="tab-pane fade"
  id="loai-tour"
  role="tabpanel"
  aria-labelledby="loai-tour-tab"
>
<div class="row filterCategory-section mb-3 pt-1 px-5"> 
  <!-- Hàng 1: Tìm kiếm -->
  <div class="row g-2">
    <div class="col-md-8">
      <div class="input-group">
        <input
          type="text"
          id="searchInputCategory"
          class="form-control border border-secondary"
          placeholder="Tìm kiếm theo ID, Tên Loại Tour"
          aria-label="Search"
          oninput="filterCategories()"
        />
        <button
          type="button"
          class="btn btn-primary"
          onclick="filterCategories()"
        >
          Tìm kiếm
        </button>
      </div>
    </div>
  </div>

  <!-- Hàng 2: Nút Thêm và Lọc -->
  <div class="row g-2 mb-2 align-items-center">
    <!-- Bộ lọc trạng thái và nút thêm -->
    <div class="d-flex justify-content-between align-items-center">
      <!-- Bộ lọc trạng thái -->
      <div class="d-flex">
        <select id="statusFilter" class="form-select me-2" onchange="filterCategories()">
          <option value="">Tất cả</option>
          <option value="1">Kích hoạt</option>
          <option value="0">Ngưng hoạt động</option>
        </select>
        <button
          type="button"
          id="btnClearStatusFilter"
          class="btn btn-secondary"
        >
          Clear
        </button>
      </div>

      <!-- Nút thêm -->
      <div>
        <button
          class="btn btn-success"
          data-bs-toggle="modal"
          data-bs-target="#addCategoryModal"
        >
          Thêm Loại Tour Mới
        </button>
      </div>
    </div>
  </div>
</div>




  <!-- Bảng Loại Tour -->
  <div class="tbCategory-container table-container">
    <table class="table tbCategory table-bordered text-center">
      <thead>
        <tr>
          <th>ID</th>
          <th>Tên Loại Tour</th>
          <th>Chi Tiết</th>
          <th>Trạng Thái</th>
          <th>Thao Tác</th>
        </tr>
      </thead>
      <tbody id="categoryTableBody">
    <tr>
      <td>1</td>
      <td>Tour Biển</td>
      <td>Thăm quan các bãi biển nổi tiếng</td>
      <td>1</td> <!-- Trạng thái: 1 = Kích hoạt, 0 = Ngưng hoạt động -->
    </tr>
    <tr>
      <td>2</td>
      <td>Tour Núi</td>
      <td>Khám phá vùng núi hùng vĩ</td>
      <td>0</td>
    </tr>
  </tbody>
        <!-- Dữ liệu sẽ được tải động qua Ajax -->
      </tbody>
    </table>
  </div>
</div>

<!-- Modal Thêm Loại Tour -->
<div
  class="modal fade"
  id="addCategoryModal"
  tabindex="-1"
  aria-labelledby="addCategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addCategoryModalLabel">Thêm Loại Tour</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="addCategoryForm" onsubmit="addCategory(); return false;">
          <!-- Tên Loại Tour -->
          <div class="mb-3">
            <label for="categoryName" class="form-label">Tên Loại Tour</label>
            <input type="text" class="form-control" id="categoryName" required />
          </div>

          <!-- Chi Tiết -->
          <div class="mb-3">
            <label for="categoryDetail" class="form-label">Chi Tiết</label>
            <textarea
              class="form-control"
              id="categoryDetail"
              rows="2"
            ></textarea>
          </div>

          <!-- Trạng Thái -->
          <div class="mb-3">
            <label for="categoryStatus" class="form-label">Trạng Thái</label>
            <select class="form-select" id="categoryStatus" required>
              <option value="1">Kích hoạt</option>
              <option value="0">Ngưng hoạt động</option>
            </select>
          </div>

          <!-- Nút -->
          <div class="d-flex justify-content-center mt-3">
            <button type="submit" class="btn btn-primary mx-2">Thêm</button>
            <button
              type="button"
              class="btn btn-secondary mx-2"
              data-bs-dismiss="modal"
            >
              Đóng
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Chỉnh Sửa Loại Tour -->
<div
  class="modal fade"
  id="editCategoryModal"
  tabindex="-1"
  aria-labelledby="editCategoryModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editCategoryModalLabel">Chỉnh Sửa Loại Tour</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="editCategoryForm" onsubmit="editCategory(); return false;">
          <!-- Trường ẩn để lưu ID -->
          <input type="hidden" id="editCategoryId" />
          <!-- Tên Loại Tour -->
          <div class="mb-3">
            <label for="editCategoryName" class="form-label">Tên Loại Tour</label>
            <input
              type="text"
              class="form-control"
              id="editCategoryName"
              required
            />
          </div>

          <!-- Chi Tiết -->
          <div class="mb-3">
            <label for="editCategoryDetail" class="form-label">Chi Tiết</label>
            <textarea
              class="form-control"
              id="editCategoryDetail"
              rows="2"
            ></textarea>
          </div>

          <!-- Trạng Thái -->
          <div class="mb-3">
            <label for="editCategoryStatus" class="form-label">Trạng Thái</label>
            <select class="form-select" id="editCategoryStatus" required>
              <option value="1">Kích hoạt</option>
              <option value="0">Ngưng hoạt động</option>
            </select>
          </div>

          <!-- Nút -->
          <div class="d-flex justify-content-center mt-3">
            <button type="submit" class="btn btn-primary mx-2">Lưu</button>
            <button
              type="button"
              class="btn btn-secondary mx-2"
              data-bs-dismiss="modal"
            >
              Đóng
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

</div>

    

<!-- -------------------------------------------------------- tour time------------------------------------------------------------------ -->

<div
  class="tab-pane fade mx-3"
  id="lich-trinh-tour"
  role="tabpanel"
  aria-labelledby="lich-trinh-tour-tab"
>
<div class="row filterTourTime-section mb-3 pt-1">
  <!-- Hàng 1: Tìm kiếm -->
  <div class="row g-2">
    <div class="col-md-10">
      <div class="input-group">
        <input
          type="text"
          id="searchInputTourTime"
          class="form-control border border-secondary"
          placeholder="Tìm kiếm theo ID, Tên, Mã Tour Time"
          aria-label="Search"
          oninput="filterTourTimes()"
        />
        <button
          type="button"
          class="btn btn-primary btnsearchtourTime"
          onclick="filterTourTimes()"
        >
          Tìm kiếm
        </button>
        <button
          type="button"
          class="btn btn-secondary ms-2"
          id="btnClearTourTime"
        >
          Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Hàng 2: Các bộ lọc và nút Thêm -->
  <div class="row g-2 mb-2 filtertourtime align-items-center">
    <!-- ComboBox TourID -->
    <div class="col-md-2">
      <select id="tourIdSelect" class="form-select" onchange="filterTourTimes()">
        <option value="">Chọn Tour ID</option>
      </select>
    </div>

    <!-- ComboBox Trạng thái -->
    <div class="col-md-2">
      <select
        id="statusSelectTourTime"
        class="form-select"
        onchange="filterTourTimes()"
      >
        <option value="">Chọn Trạng Thái</option>
        <option value="1">Hoạt động</option>
        <option value="0">Ngưng hoạt động</option>
      </select>
    </div>

    <!-- ComboBox Khoảng giá -->
    <div class="col-md-3">
      <select id="priceFilter" class="form-select" onchange="filterTourTimes()">
        <option value="">Chọn khoảng giá</option>
        <option value="100000">Dưới 100,000 VNĐ</option>
        <option value="100000-500000">Từ 100,000 đến 500,000 VNĐ</option>
        <option value="500000-1000000">Từ 500,000 đến 1,000,000 VNĐ</option>
        <option value="1000000-5000000">Từ 1,000,000 đến 5,000,000 VNĐ</option>
        <option value="5000000+">Trên 5,000,000 VNĐ</option>
      </select>
    </div>

    <!-- Ô nhập Ngày đi -->
    <div class="col-md-2">
      <input
        type="date"
        id="startDate"
        class="form-control"
        onchange="filterTourTimes()"
      />
    </div>

    <div class="col-md-1"></div>

    <!-- Nút Thêm -->
    <div class="col-md-2 text-end">
      <button
        class="btn btn-success w-100"
        data-bs-toggle="modal"
        data-bs-target="#addTourTimeModal"
      >
        Thêm Tour Time Mới
      </button>
    </div>
  </div>
</div>

  <!-- Hàng 3: Nút Thêm -->



<!-- Bảng Tour Time -->
<div class="tbTourTime-container table-container">
  <table class="table tbTourTime table-bordered text-center">
    <thead>
      <tr>
        <th>ID</th>
        <th>Tên Tour Time</th>
        <th>TourID</th>
        <th>Thời Gian Đi</th>
        <th>Giá Người Lớn</th>
        <th>Giá Trẻ Em</th>
        <th>Trạng Thái</th>
        <th>Thao Tác</th>
      </tr>
    </thead>
    <tbody id="tourTimeTableBodyMain">
      <!-- Dữ liệu sẽ được tải động qua Ajax -->
    </tbody>
  </table>
</div>
</div>

<!-- Modal Khuyến Mãi -->
<div class="modal fade" id="discountModal" tabindex="-1" aria-labelledby="discountModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="discountModalLabel" style="font-size: 1.2rem;">Thêm Khuyến Mãi</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Form chọn loại khuyến mãi -->
        <form id="addDiscountForm" onsubmit="addDiscount(); return false;">
          <!-- Thêm trường ẩn cho tourId -->
          <input type="hidden" id="tourId" name="tourId" value="">

          <div class="row mb-3">
            <div class="col-md-8">
              <label for="discountType" class="form-label">Chọn Loại Khuyến Mãi</label>
              <select id="discountType" class="form-select" required>
                <option value="" disabled selected>-- Chọn loại khuyến mãi --</option>
                <!-- Các khuyến mãi sẽ được thêm vào đây bằng JavaScript -->
              </select>
            </div>
            <div class="col-md-4 d-flex align-items-end">
              <button type="submit" class="btn btn-primary w-100">Thêm</button>
            </div>
          </div>
        </form>

        <!-- Bảng các khuyến mãi đã chọn -->
        <div class="table-responsive">
          <table class="table table-bordered table-hover">
            <thead class="table-light">
              <tr>
                <th scope="col">ID</th>
                <th scope="col">Mã Giảm Giá</th>
                <th scope="col">Giảm Giá</th>
                <th scope="col">Ngày Bắt Đầu</th>
                <th scope="col">Ngày Kết Thúc</th>
                <th scope="col">Mô Tả</th>
                <th scope="col">Trạng Thái</th>
                <th scope="col">Hành Động</th>
              </tr>
            </thead>
            <tbody id="selectedDiscounts">
              <!-- Dòng khuyến mãi được thêm sẽ hiển thị ở đây -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Thêm Phương Tiện -->
<div class="modal fade" id="transportModal" tabindex="-1" aria-labelledby="transportModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="transportModalLabel" style="font-size: 1.2rem;">Thêm Phương Tiện Cho Tour</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Form chọn mã phương tiện -->
        <form id="addTransportForm" onsubmit="addTransport(); return false;">
          <input type="hidden" id="tourTimeId" name="tourTimeId" value=""> <!-- Thêm trường tourTimeId ẩn -->

          <div class="row mb-3">
            <div class="col-md-12">
              <label for="transportId" class="form-label">Chọn Mã Phương Tiện</label>
              <select id="transportId" class="form-select" required>
                <option value="" disabled selected>-- Chọn phương tiện --</option>
                <!-- Các phương tiện sẽ được thêm vào đây bằng JavaScript -->
              </select>
            </div>
          </div>

          

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="departureDate" class="form-label">Ngày khởi hành</label>
              <input type="date" id="departureDate" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label for="departureHour" class="form-label">Giờ khởi hành</label>
              <select id="departureHour" class="form-select" required>
                <option value="" disabled selected>-- Chọn giờ --</option>
                <!-- Thêm các giờ vào đây bằng JavaScript -->
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="departureMinute" class="form-label">Phút khởi hành</label>
              <select id="departureMinute" class="form-select" required>
                <option value="" disabled selected>-- Chọn phút --</option>
                <option value="00">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
            </div>
          </div>
<div class="row mb-3">
            <div class="col-md-6">
              <label for="arrivalDate" class="form-label">Ngày đến</label>
              <input type="date" id="arrivalDate" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label for="arrivalHour" class="form-label">Giờ đến</label>
              <select id="arrivalHour" class="form-select" required>
                <option value="" disabled selected>-- Chọn giờ --</option>
                <!-- Thêm các giờ vào đây bằng JavaScript -->
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="arrivalMinute" class="form-label">Phút đến</label>
              <select id="arrivalMinute" class="form-select" required>
                <option value="" disabled selected>-- Chọn phút --</option>
                <option value="00">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
            </div>
          </div>
          <!-- Trạng thái -->
          <div class="row mb-3">
            <div class="col-md-12">
              <label for="status" class="form-label">Trạng thái</label>
              <select id="status" class="form-select" required>
                <option value="" disabled selected>-- Chọn trạng thái --</option>
                <option value="1">Hoạt động</option>
                <option value="0">Không hoạt động</option>
              </select>
            </div>
          </div>

          <!-- Nút Thêm Phương Tiện -->
          <div class="row mb-3">
            <div class="col-md-12 text-end">
              <button type="button" id="addtransport" class="btn btn-primary w-100">Thêm Phương Tiện</button>
            </div>
          </div>
        </form>

        <!-- Bảng các phương tiện đã chọn -->
        <div class="table-responsive">
          <table class="table table-bordered table-hover">
            <thead class="table-light">
              <tr>
                <th scope="col">Mã Phương Tiện</th>
                <th scope="col">Tên Phương Tiện</th>
                <th scope="col">Thời gian đến</th>
                <th scope="col">Thời gian khởi hành</th>
                <th scope="col">Trạng thái</th>
                <th scope="col">Hành Động</th>
              </tr>
            </thead>
            <tbody id="selectedTransports">
              <!-- Các phương tiện đã chọn sẽ được thêm vào đây bằng JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Thêm Tour Time -->
<div class="modal fade" id="addTourTimeModal" tabindex="-1" aria-labelledby="addTourTimeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" style="margin-top: 10px">
    <div class="modal-content">
      <!-- Tiêu đề Modal -->
      <div class="modal-header bg-primary text-white" style="height: 40px">
        <h5 class="modal-title fw-bold" id="addTourTimeModalLabel" style="font-size: 1.2rem;">Thêm Tour Time</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <!-- Nội dung Modal -->
      <div class="modal-body">
        <form id="addTourTimeForm" onsubmit="addTourTime(); return false;">
          <!-- Tên và mã Tour Time -->
          <div class="row g-3">
            <div class="col-md-6">
              <label for="timeName" class="form-label fw-semibold">Tên Tour Time</label>
              <input type="text" class="form-control" id="timeName" placeholder="Nhập tên Tour Time" required>
            </div>
            <div class="col-md-6">
              <label for="tourTimeCode" class="form-label fw-semibold">Tour Time Code</label>
              <input type="text" class="form-control" id="tourTimeCode" placeholder="Nhập mã Tour Time" required>
            </div>
          </div>

          <!-- Tour ID và Tên Tour -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="tourId" class="form-label fw-semibold">Tour ID</label>
              <input type="number" class="form-control" id="tourIdinTourTime" oninput="fetchTourNameAddEdit(this.value)" placeholder="Nhập ID Tour" required>
            </div>
            <div class="col-md-6">
              <label for="tourName" class="form-label fw-semibold">Tên Tour</label>
              <input type="text" class="form-control" id="tourNameinTourTime" readonly>
            </div>
          </div>

          <!-- Ngày, giờ và phút -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="departureDate" class="form-label fw-semibold">Ngày khởi hành</label>
              <input type="date" id="departureDateinTourTime" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label for="departureHour" class="form-label fw-semibold">Giờ khởi hành</label>
              <select id="departureHourinTourTime" class="form-select" required>
                <option value="" disabled selected>-- Chọn giờ --</option>
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="departureMinute" class="form-label fw-semibold">Phút khởi hành</label>
              <select id="departureMinuteinTourTime" class="form-select" required>
                <option value="" disabled selected>-- Chọn phút --</option>
                <option value="00">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
            </div>
          </div>

          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="arrivalDate" class="form-label fw-semibold">Ngày đến</label>
              <input type="date" id="arrivalDateinTourTime" class="form-control" required>
            </div>
            <div class="col-md-3">
              <label for="arrivalHour" class="form-label fw-semibold">Giờ đến</label>
              <select id="arrivalHourinTourTime" class="form-select" required>
                <option value="" disabled selected>-- Chọn giờ --</option>
                <option value="00">00</option>
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="arrivalMinute" class="form-label fw-semibold">Phút đến</label>
              <select id="arrivalMinuteinTourTime" class="form-select" required>
                <option value="" disabled selected>-- Chọn phút --</option>
                <option value="00">00</option>
                <option value="15">15</option>
                <option value="30">30</option>
                <option value="45">45</option>
              </select>
            </div>
          </div>

          <!-- Giá và trạng thái -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="priceAdult" class="form-label fw-semibold">Giá Người Lớn</label>
              <input type="number" class="form-control" id="priceAdultinTourTime" placeholder="VNĐ" required>
            </div>
            <div class="col-md-6">
              <label for="priceChild" class="form-label fw-semibold">Giá Trẻ Em</label>
              <input type="number" class="form-control" id="priceChildinTourTime" placeholder="VNĐ" required>
            </div>
          </div>

          <!-- Số lượng và ghi chú -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="quantity" class="form-label fw-semibold">Số lượng</label>
              <input type="number" class="form-control" id="quantityinTourTime" placeholder="Nhập số lượng" required>
            </div>
            <div class="col-md-6">
              <label for="note" class="form-label fw-semibold">Ghi Chú</label>
              <textarea class="form-control" id="noteinTourTime" rows="2" placeholder="Nhập ghi chú"></textarea>
            </div>
          </div>

          <!-- Nút hành động -->
          <div class="row d-flex justify-content-center mt-4">
            <button type="submit" class="col-md-3 btn btn-primary">Thêm Tour Time</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Chỉnh Sửa Tour Time -->
<div class="modal fade" id="editTourTimeModal" tabindex="-1" aria-labelledby="editTourTimeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" style="margin-top: 10px">
    <div class="modal-content">
      <!-- Tiêu đề Modal -->
      <div class="modal-header bg-primary text-white" style="height: 40px">
        <h5 class="modal-title fw-bold" id="editTourTimeModalLabel" style="font-size: 1.2rem;">Chỉnh Sửa Tour Time</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <input type="hidden" id="editTourTimeId" name="tourTimeId">
      
      <!-- Nội dung Modal -->
      <div class="modal-body">
        <form id="editTourTimeForm" onsubmit="editTourTime(); return false;">
          <!-- Tên và mã Tour Time -->
          <div class="row g-3">
            <div class="col-md-6">
              <label for="timeName" class="form-label fw-semibold">Tên Tour Time</label>
              <input type="text" class="form-control" id="editTimeName" placeholder="Nhập tên Tour Time" required>
            </div>
            <div class="col-md-6">
              <label for="tourTimeCode" class="form-label fw-semibold">Tour Time Code</label>
              <input type="text" class="form-control" id="editTourTimeCode" placeholder="Nhập mã Tour Time" required>
            </div>
          </div>

          <!-- Tour ID và Tên Tour (không cho chỉnh sửa Tour ID) -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="tourId" class="form-label fw-semibold">Tour ID</label>
              <input type="text" class="form-control" id="editTourIdinTT" readonly placeholder="ID Tour" required>
            </div>
            <div class="col-md-6">
              <label for="tourName" class="form-label fw-semibold">Tên Tour</label>
              <input type="text" class="form-control" id="editTourNameinTT" readonly>
            </div>
          </div>

          <!-- Ngày khởi hành và ngày đến (cùng hàng) -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="departureDate" class="form-label fw-semibold">Ngày khởi hành</label>
              <input type="text" id="editDepartureDate" class="form-control" required readonly>
            </div>
            <div class="col-md-6">
              <label for="arrivalDate" class="form-label fw-semibold">Ngày đến</label>
              <input type="text" id="editArrivalDate" class="form-control" readonly required>
            </div>
          </div>

          <!-- Giá và trạng thái -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="priceAdult" class="form-label fw-semibold">Giá Người Lớn</label>
              <input type="number" class="form-control" id="editPriceAdult" placeholder="VNĐ" required>
            </div>
            <div class="col-md-6">
              <label for="priceChild" class="form-label fw-semibold">Giá Trẻ Em</label>
              <input type="number" class="form-control" id="editPriceChild" placeholder="VNĐ" required>
            </div>
          </div>

          <!-- Số lượng, trạng thái và ghi chú -->
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <label for="quantity" class="form-label fw-semibold">Số lượng</label>
              <input type="number" class="form-control" id="editQuantity" placeholder="Nhập số lượng" required>
            </div>

            <!-- Trạng thái -->
            <div class="col-md-6">
              <label for="status" class="form-label fw-semibold">Trạng thái</label>
<select id="editStatus" class="form-control" required>
    <option value="1">Hoạt động</option>
    <option value="0">Ngưng hoạt động</option>
</select>

            </div>
          </div>

          <!-- Ghi chú -->
          <div class="row g-3 mt-2">
            <div class="col-md-12">
              <label for="note" class="form-label fw-semibold">Ghi Chú</label>
              <textarea class="form-control" id="editNote" rows="2" placeholder="Nhập ghi chú"></textarea>
            </div>
          </div>

          <!-- Nút hành động -->
          <div class="row d-flex justify-content-center mt-4">
			<button class="col-md-3 btn btn-primary"  onclick="updateTourTime()">Chỉnh Sửa Tour Time</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>







</div>

    
    
    <script>
  document.addEventListener("DOMContentLoaded", () => {
    const tabButtons = document.querySelectorAll(".nav-link");
    const tabContents = document.querySelectorAll(".tab-pane");

    // Hiển thị tab "Danh sách Tour" mặc định khi tải trang
    const defaultTab = document.getElementById("quan-ly-tour");
    const defaultTabButton = document.getElementById("quan-ly-tour-tab");
    if (defaultTab) {
      defaultTab.style.display = "block"; // Hiển thị tab mặc định
      defaultTab.classList.add("show", "active");
    }

    // Ẩn các tab còn lại
    tabContents.forEach((content) => {
      if (content !== defaultTab) {
        content.style.display = "none"; // Ẩn các tab khác
        content.classList.remove("show", "active");
      }
    });

    tabButtons.forEach((button) => {
      button.addEventListener("click", (event) => {
        const target = event.target.getAttribute("data-bs-target");

        // Ẩn tất cả các tab content
        tabContents.forEach((content) => {
          content.classList.remove("show", "active"); // Ẩn tất cả nội dung tab
          content.style.display = "none"; // Đảm bảo ẩn tab hoàn toàn
        });

        // Hiển thị nội dung tab được chọn
        const selectedContent = document.querySelector(target);
        if (selectedContent) {
          selectedContent.classList.add("show", "active");
          selectedContent.style.display = "block"; // Hiển thị nội dung tab
        }

        // Cập nhật trạng thái của các tab
        tabButtons.forEach((btn) => {
          if (btn === event.target) {
            btn.classList.add("active"); // Thêm class active vào tab đang chọn
          } else {
            btn.classList.remove("active"); // Gỡ class active khỏi tab khác
          }
        });
      });
    });
  });
</script>


<script>
function showTourTimes(tourId) {
	  // Gọi API để lấy danh sách TourTime của tour
	  fetch(`/admin/gettourtimesbytourID/${tourId}`)
	    .then(response => {
	      if (!response.ok) {
	        throw new Error('Network response was not ok');
	      }
	      return response.json();
	    })
	    .then(data => {
	      // Lấy phần tử tbody trong modal để chèn dữ liệu
	      const tourTimeTableBody = document.getElementById("tourTimeTableBody");

	      // Xóa các hàng cũ trong bảng
	      tourTimeTableBody.innerHTML = '';

	      // Duyệt qua danh sách TourTime và thêm vào bảng
	      data.forEach(tourTime => {
	        const row = document.createElement('tr');
	        row.innerHTML = `
	          <td>${tourTime.tourTimeId}</td>
	          <td>${tourTime.tourTimeCode}</td>
	          <td>${tourTime.timeName}</td>
	          <td>${new Date(tourTime.departureTime).toLocaleString()}</td>
	          <td>${new Date(tourTime.returnTime).toLocaleString()}</td>
	          <td>${tourTime.priceAdult}</td>
	          <td>${tourTime.priceChild}</td>
	          <td>${tourTime.status === 1 ? 'Kích hoạt' : 'Ngưng hoạt động'}</td>
	        `;
	        tourTimeTableBody.appendChild(row);
	      });

	      // Mở modal
	      const myModal = new bootstrap.Modal(document.getElementById('tourTimeModal'));
	      myModal.show();
	    })
	    .catch(error => {
	      console.error('Error fetching tour times:', error);
	    });
	}
function filterTourTimes() {
    const searchInput = document.getElementById("searchInputTourTime").value.toLowerCase(); // Lấy giá trị tìm kiếm
    const tourIdFilter = document.getElementById("tourIdSelect").value; // Lọc theo Tour ID
    const statusFilter = document.getElementById("statusSelectTourTime").value; // Lọc theo trạng thái
    const priceFilter = document.getElementById("priceFilter").value; // Lọc theo khoảng giá
    const startDateFilter = document.getElementById("startDate").value; // Lọc theo ngày đi
    const tableRows = document.querySelectorAll("#tourTimeTableBodyMain tr"); // Lấy tất cả các dòng của bảng

    // Hàm chuyển đổi định dạng ngày từ "1/2/2024, 9:49:32 PM" thành "yyyy-mm-dd"
    function formatDateToYYYYMMDD(dateString) {
        const date = new Date(dateString); // Chuyển đổi chuỗi thành đối tượng Date
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0'); // Tháng trong JavaScript bắt đầu từ 0
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`; // Trả về định dạng yyyy-mm-dd
    }

    tableRows.forEach((row) => {
        const tourTimeID = row.cells[0].innerText.toLowerCase(); // Cột ID Tour Time
        const tourTimeName = row.cells[1].innerText.toLowerCase(); // Cột Tên Tour Time
        const tourID = row.cells[2].innerText.toLowerCase(); // Cột ID Tour
        const departureTime = row.cells[3].innerText.toLowerCase(); // Cột Ngày đi (ví dụ: "1/2/2024, 9:49:32 PM")
        const price = row.cells[4].innerText.toLowerCase(); // Cột Giá
        const status = row.cells[6].innerText.toLowerCase().trim(); // Cột Trạng Thái

        // Chuyển đổi departureTime thành định dạng yyyy-mm-dd
        const formattedDepartureTime = formatDateToYYYYMMDD(departureTime);

        // Kiểm tra các điều kiện tìm kiếm
        const matchesSearch =
            tourTimeID.includes(searchInput) ||
            tourTimeName.includes(searchInput);

        const matchesTourID = !tourIdFilter || tourID === tourIdFilter;
        const matchesStatus =
            !statusFilter || (statusFilter === "1" && status === "hoạt động") ||
            (statusFilter === "0" && status === "ngưng hoạt động");

        const matchesPrice = !priceFilter || checkPriceRange(price, priceFilter);  // Hàm checkPriceRange chưa được cung cấp, cần phải xác định thêm
        const matchesStartDate = !startDateFilter || formattedDepartureTime.includes(startDateFilter); // So sánh ngày sau khi chuyển đổi

        // Kiểm tra điều kiện lọc và ẩn/hiện các dòng tương ứng
        if (
            matchesSearch &&
            matchesTourID &&
            matchesStatus &&
            matchesPrice &&
            matchesStartDate
        ) {
            row.style.display = ""; // Hiển thị dòng
        } else {
            row.style.display = "none"; // Ẩn dòng
        }
    });
}





function checkPriceRange(price, priceFilter) {
    const priceValue = parseInt(price.replace(/\D/g, '')); // Lọc bỏ ký tự không phải số trong giá
    switch (priceFilter) {
        case "100000":
            return priceValue < 100000;
        case "100000-500000":
            return priceValue >= 100000 && priceValue <= 500000;
        case "500000-1000000":
            return priceValue > 500000 && priceValue <= 1000000;
        case "1000000-5000000":
            return priceValue > 1000000 && priceValue <= 5000000;
        case "5000000+":
            return priceValue > 5000000;
        default:
            return true;
    }
}

</script>
<script>

      function filterTours() {
        const searchInput = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const categoryFilter = document.getElementById("categorySelect").value;
        const statusFilter = document.getElementById("statusSelect").value;
        const tableRows = document.querySelectorAll("#tourTableBody tr");
        tableRows.forEach((row) => {
          const tourID = row.cells[0].innerText.toLowerCase(); // Cột ID Tour
          const tourName = row.cells[1].innerText.toLowerCase(); // Cột Tên Tour
          const tourCode = row.cells[4].innerText.toLowerCase(); // Cột Mã Tour
          const status = row.cells[3].innerText.toLowerCase().trim(); // Cột Trạng Thái
          const tourCategoryId = row.cells[6].getAttribute("data-category-id"); // Lấy giá trị từ data-category-id	        // Kiểm tra nếu searchInput có trong tourID, tourName hoặc tourCode
          const matchesSearch =
            tourID.includes(searchInput) ||
            tourName.includes(searchInput) ||
            tourCode.includes(searchInput);

          // Kiểm tra loại tour
          const matchesCategory =
            categoryFilter === "" || // Nếu loại tour là Tất cả
            tourCategoryId === categoryFilter; // So sánh với categoryFilter

          // Kiểm tra trạng thái
          const matchesStatus =
            statusFilter === "" || // Nếu trạng thái là Tất cả
            (statusFilter === "1" && status === "kích hoạt") ||
            (statusFilter === "0" && status === "ngưng hoạt động");

          // Nếu ô tìm kiếm không trống và không khớp với các điều kiện
          if (searchInput && matchesSearch) {
            row.style.display = matchesCategory && matchesStatus ? "" : "none"; // Hiển thị hoặc ẩn dựa trên điều kiện
          } else if (!searchInput) {
            // Nếu ô tìm kiếm trống, chỉ cần kiểm tra loại tour và trạng thái
            row.style.display = matchesCategory && matchesStatus ? "" : "none";
          } else {
            row.style.display = "none"; // Ẩn hàng nếu không khớp với tìm kiếm
          }
        });
      }
    </script>

    <!------------------------ category -->
    <script>
    function loadCategories() {
        fetch('/admin/categories/list')
            .then(response => response.json())
            .then(data => {
                // Sắp xếp danh sách theo ID tăng dần
                data.sort((a, b) => a.categoryId - b.categoryId);

                const tableBody = document.getElementById('categoryTableBody');
                tableBody.innerHTML = data
                    .map(
                        category => `
                            <tr>
                                <td>${category.categoryId}</td>
                                <td>${category.categoryName}</td>
                                <td>${category.categoryDetail || 'Không có'}</td>
                                <td>${category.status === 1 ? 'Kích hoạt' : 'Ngưng hoạt động'}</td>
                                <td>
                                <button class="btn btn-sm btn-primary" onclick="showEditModal(${category.categoryId})">Chỉnh sửa</button>
                                    <button 
                                        class="btn btn-sm btn-danger" 
                                        ${category.status === 0 ? 'disabled' : ''}
                                        onclick="confirmDeleteCategory(${category.categoryId})">
                                        ${category.status === 0 ? 'Đã xóa' : 'Xóa'}
                                    </button>
                                </td>
                            </tr>
                        `
                    )
                    .join('');
            })
            .catch(error => console.error('Error loading categories:', error));
    }
 // Gọi hàm load khi trang được tải
    document.addEventListener('DOMContentLoaded', loadCategories);
 // Hàm lọc danh sách loại tour theo ID hoặc Tên
    function filterCategories() {
	  const searchInput = document.getElementById('searchInputCategory').value.toLowerCase();
	  const statusFilter = document.getElementById('statusFilter').value; // Lấy giá trị trạng thái
	  const tableRows = document.querySelectorAll('#categoryTableBody tr');
	
	  tableRows.forEach(row => {
	    const id = row.children[0].innerText.toLowerCase();
	    const name = row.children[1].innerText.toLowerCase();
	    const status = row.children[3].innerText.trim(); // Giả sử cột trạng thái là cột thứ 4
		
	 // Định dạng so sánh trạng thái
	    const isStatusMatch = 
	      statusFilter === '' || // Tất cả
	      (statusFilter === '1' && status === 'Kích hoạt') ||
	      (statusFilter === '0' && status === 'Ngưng hoạt động');
	    // Kiểm tra từ khóa và trạng thái
	    const matchesSearch = id.includes(searchInput) || name.includes(searchInput);
	    //const matchesStatus = statusFilter === '' || status === statusFilter;
	
	    // Hiển thị hàng nếu cả hai điều kiện đều đúng
	    row.style.display = matchesSearch && isStatusMatch ? '' : 'none';
	  });
	}


    function addCategory() {
        const name = document.getElementById('categoryName').value;
        const detail = document.getElementById('categoryDetail').value;
        const status = document.getElementById('categoryStatus').value;

        const data = { categoryName: name, categoryDetail: detail, status: parseInt(status) };

        fetch('/admin/categories/add', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        })
        .then(response => response.json())
        .then(() => {
            loadCategories();
            clearFormSearch();
            hideModal('addCategoryModal');
            showAlert('success', 'Thêm loại tour thành công!');
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('danger', 'Có lỗi xảy ra khi thêm loại tour!');
        });
    }
    
 

 // Biến để lưu ID của loại tour cần xóa
    let categoryIdToDelete = null;

    // Hàm để hiển thị modal xác nhận xóa
    function confirmDeleteCategory(categoryId) {
      categoryIdToDelete = categoryId; // Lưu ID của loại tour cần xóa
      // Mở modal xác nhận xóa
      const modal = new bootstrap.Modal(document.getElementById('confirmDeleteModal'));
      modal.show();
    }

    // Hàm để thực hiện xóa khi người dùng xác nhận
    document.getElementById('confirmDeleteButton').addEventListener('click', function() {
      // Gửi yêu cầu xóa
      fetch(`/admin/categories/delete/${categoryIdToDelete}`, {
        method: 'DELETE',
      })
        .then(response => {
          if (response.ok) {
        	  showAlert('success', 'Xóa loại tour thành công!');
            loadCategories(); // Tải lại danh sách loại tour
            clearFormSearch();
          } else {
        	  showAlert('danger', 'Có lỗi xảy ra khi xóa loại tour!');
          }
        })
        .catch(error => {
          console.error('Error deleting category:', error);
          alert('Có lỗi xảy ra khi xóa loại tour!');
        })
        .finally(() => {
          // Đóng modal
          const modal = bootstrap.Modal.getInstance(document.getElementById('confirmDeleteModal'));
          modal.hide();
        });
    });
    //hàm 
    function hideModal(modalId) {
        const modal = bootstrap.Modal.getInstance(document.getElementById(modalId));
        modal.hide();

        // Xóa thủ công lớp `modal-backdrop` nếu còn
        const backdrop = document.querySelector('.modal-backdrop');
        if (backdrop) {
            backdrop.remove();
        }

        // Xóa lớp `modal-open` trên body nếu còn
        document.body.classList.remove('modal-open');
        document.body.style = ''; // Reset overflow và padding
    }


 // Hàm hiển thị modal chỉnh sửa
    function showEditModal(categoryId) {
      // Lấy dữ liệu loại tour theo ID
      fetch(`/admin/categories/${categoryId}`)
        .then(response => response.json())
        .then(category => {
          // Điền dữ liệu vào modal
          document.getElementById('editCategoryId').value = category.categoryId;
          document.getElementById('editCategoryName').value = category.categoryName;
          document.getElementById('editCategoryDetail').value = category.categoryDetail || '';
          document.getElementById('editCategoryStatus').value = category.status;

          // Mở modal
          new bootstrap.Modal(document.getElementById('editCategoryModal')).show();
        })
        .catch(error => console.error('Error fetching category details:', error));
    }

    // Hàm chỉnh sửa loại tour
    function editCategory() {
      const categoryId = document.getElementById('editCategoryId').value;
      const categoryName = document.getElementById('editCategoryName').value;
      const categoryDetail = document.getElementById('editCategoryDetail').value;
      const categoryStatus = document.getElementById('editCategoryStatus').value;

      fetch(`/admin/categories/update/${categoryId}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          categoryName,
          categoryDetail,
          status: categoryStatus,
        }),
      })
        .then(response => response.json())
        .then(updatedCategory => {
          //alert('Chỉnh sửa thành công!');
          loadCategories(); // Tải lại danh sách loại tour
          clearFormSearch();
          // Đóng modal
          const modal = bootstrap.Modal.getInstance(document.getElementById('editCategoryModal'));
          modal.hide();
          showAlert('success', 'Chỉnh sửa thành công!');
        })
        .catch(error => console.error('Error updating category:', error));
      	//showAlert('danger', 'Có lỗi xảy ra khi chỉnh sửa loại tour!');
    }
    function showAlert(type, message) {
        const alertContainer = document.getElementById('alert-container');
        if (alertContainer) {
            const alertBox = document.createElement('div');
            alertBox.className = `alert alert-${type}`;
            alertBox.innerText = message;
            alertContainer.appendChild(alertBox);
            alertBox.style.display = 'block';
            alertBox.style.opacity = 1; // Bắt đầu với độ mờ đầy đủ
            
            // Thêm hiệu ứng mờ dần và xóa alert sau 3 giây
            setTimeout(() => {
                alertBox.style.opacity = 0; // Bắt đầu mờ dần
                setTimeout(() => {
                    alertBox.remove(); // Xóa alert khỏi DOM sau khi đã mờ
                }, 600); // Thời gian để mờ
            }, 3000); // Thời gian để hiển thị alert
        } else {
            console.error('Phần tử alert-container không tồn tại.');
        }
    }
    document.getElementById('btnClearStatusFilter').addEventListener('click', function () {
    	  // Clear input tìm kiếm
    	  document.getElementById('searchInputCategory').value = '';

    	  // Reset giá trị của select trạng thái
    	  document.getElementById('statusFilter').value = '';

    	  // Gọi lại hàm lọc để hiển thị tất cả danh mục
    	  loadCategories();
    	});

    function clearFormSearch() {
	    // Xóa nội dung ô input tìm kiếm
	    document.getElementById('searchInputCategory').value = '';

	    // Đặt lại các ô select về giá trị mặc định
	    //document.getElementById('statusFilter').selectedIndex = 0;
	}
    </script>
    
        <script src="/admin/js/tour.js"></script>
    <script src="/admin/js/imageModal.js"></script>
    <script src="/admin/js/tourTime.js"></script>
  </body>
</html>
